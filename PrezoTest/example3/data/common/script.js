//Version 1.0.3.6
function loadPres(e,t){function n(e,t){return-1!==e.indexOf(t,e.length-t.length)}gc=t||1,gv.b=t,isNaN(gc)&&(gc=1),gc=1>gc?1:gc,gv.y.OnLoadingStart();for(var r=document.getElementsByTagName("head")[0],a=r.getElementsByTagName("script"),i=0;i<a.length;i++)n(a[i].src,"scriptInit.js")&&r.removeChild(a[i]);var o=gv.o("DopFontFamily");o&&r.removeChild(o);var s=document.createElement("script");s.setAttribute("type","text/javascript"),s.src=gv.d+e+"/scriptInit.js",r.appendChild(s)}function loadContent(e,t,n){function r(){return clearTimeout(gli),cfc.l(gc)?(acc.t(),gpc==gc?gStartTime=gtct-gslength[gc-1]:gc>gpc?gStartTime-=gslength[gc-1]-anima["s"+gpc].f:gpc>gc&&(gStartTime+=anima["s"+gpc].f-gslength[gc-1]),gt=gslength[gc-1],cfc.hf.add(gc),void ncc.y()):void(gli=setTimeout(r,100))}var a=gv.o("resizer"),i=a.getAttribute("style");i+="-moz-font-feature-settings: 'liga' 0;-webkit-font-feature-settings: 'liga' 0;-ms-font-feature-settings: 'liga' 0;-o-font-feature-settings: 'liga' 0;font-feature-settings: 'liga' 0;text-rendering: optimizeSpeed;",a.setAttribute("style",i);var o,s=gv.o("giItT1WQy");s&&s.parentNode.removeChild(s),gv.bs?anima["s"+t].s.b=!0:(a.innerHTML="",a.innerHTML=n.join(""),cfc.q(gc)),a.innerHTML+=gv.e;var c,l,g,u;if(""!==document.createElement("detect").style.textShadow)for(l=gv.bs?o.getElementsByTagName("pre"):document.getElementsByTagName("pre"),u=0;u<l.length;u++)"transparent"==l[u].style.color&&(g=l[u].getAttribute("style"),c=g.indexOf("rgba"),0>c||(g=g.substring(c,g.length),l[u].style.color=g.substring(0,g.indexOf(")")+1)));if(gc=gc>gv.t?gv.t:gc,gv.bs){if(cfc.s(t),gc!=t)return}else cfc.s(gc);r()}function play(){gStartTime+=(new Date).getTime()-gtct,gpp=0,gafi=UpdategT(),0!=gafi&&(gp=1,gv.y.OnPlayingStart())}function pause(){gpp=1,gp=0,gv.y.OnPlayingEnd()}function scormGoTo(e){""!=e&&(gc=parseInt(e))}function RListener(e){return 0!=gv.q?void(e.style.opacity=.7):void(gv.o("resizer").onclick=null)}function AListener(e){return 0!=gv.q?void(e.style.opacity=1):void(1==gv.g&&(gv.o("resizer").onclick=ncc.n))}function hwr(o,c,a){var d=o.getElementsByTagName("div");if(d.length>0){if(0==DOPStyle.s(d[0],"opacity")&&0==o.getElementsByTagName("canvas").length)return}else if(0==DOPStyle.s(o.parentNode,"opacity")&&0==o.parentNode.parentNode.getElementsByTagName("canvas").length)return;if(1==c&&window.open(a),0==c)if(0===customGoto.length)ncc.z(a);else try{eval(customGoto.replace("%%slideindex%%",a))}catch(e){}}var gc=1,gd=0,gli=0,gln=0,gpc=1,au=[],gx=0,gxf=!1,gt=0,gpp=1,gp=0,gStartTime=0,gtct=0,gafi=0,gplength=0,gslength=[],fcon=0,objDopPhSco,anima,gv={n:0,o:function(e){return document.getElementById(e)}},DopPresentation=function(e,t){function n(){ncc.n()}function r(){ncc.p()}function a(){ncc.P()}function i(){ncc.Ps()}function o(e){e||(e=gc),e--;for(var t=gv.fn[e],n="",r=t.length,a=0;r>a;a++)for(var i=t[a],o=i[1],s=o.length,c=0;s>c;c++){var l=o[c],g=l[0];n+=g}return n}function s(e){function t(e,t){for(var n="";t--;)n+=e>>t&1;return n}e||(e=gc),e--;var n=gv.fn[e];"undefined"==typeof n&&(n=[]);for(var r=[],a=n.length,i=0;a>i;i++){var o=n[i],s={};s.words=[],s.level=o[0];for(var c=o[1],l=c.length,g=0;l>g;g++){var u=c[g],d={};d.text=u[0];var f=u[1];f=t(f,4),d.bold="1"===f[0]?!0:!1,d.italic="1"===f[1]?!0:!1,d.line_through="1"===f[2]?!0:!1,d.underline="1"===f[3]?!0:!1,s.words[s.words.length]=d}r[r.length]=s}return r}function c(){ncc.z(gc+1)}function l(){ncc.z(gc-1)}function g(e){ncc.z(e)}function u(){return cfc.dl()}function d(e){gv.d=e}function f(e,t){loadPres(e,t)}function v(e){gv.r=e}function m(){var e=0;return anima["s"+gc].c&&(e=anima["s"+gc].c.i),e}function h(){return 1===anima["s"+gc].t.n?(acc.P(),a(),!0):!1}return gv.y=e,gv.z=t?t:{},{Next:n,Prev:r,Play:a,Pause:i,GetNotes:o,GetFormatedNotes:s,NxtSlide:c,PrvSlide:l,GotoSlide:g,GetContentDetails:u,SetRPath:d,LoadPres:f,SetScale:v,GetCurrentAnimationCount:m,playAutomaticAnimations:h}},init=function(){function l(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),n=0;n<t.length;n++)v[t[n]]=n;e=e.replace(new RegExp("[^"+t.join("")+"=]","g"),"");var r="="==e.charAt(e.length-1)?"="==e.charAt(e.length-2)?"AA":"A":"",a="";e=e.substr(0,e.length-r.length)+r;for(var i=0;i<e.length;i+=4){var o=(v[e.charAt(i)]<<18)+(v[e.charAt(i+1)]<<12)+(v[e.charAt(i+2)]<<6)+v[e.charAt(i+3)];a+=String.fromCharCode(o>>>16&255,o>>>8&255,255&o)}return a.substring(0,a.length-r.length)}function k(e){return e.substring(0,e.indexOf("{"))}function m(e){return e.substring(e.indexOf("{")+1)}function j(s){return eval(s)}function w(e){return document.createElement(e)}function x(e,t){return t.appendChild(e)}function u(e,t,n){e.setAttribute(t,n)}function cTs(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}function siv(){gslength[0]=0;for(var e,t=1;t<=gv.t;t++)if(e=anima["s"+t],e.f=gslength[t]=gslength[t-1],gslength[t]+=e.t.i,e=e.c,0!=e)for(n in e)"undefined"!=typeof e[n].i&&(gslength[t]+=e[n].i);gplength=gslength[gslength.length-1]}function pan_Zoom(e,t){var n=e.touches.length;return 1===n?pan(e,t):2===n?(zoom(t),!0):!1}function pan(e,t){function n(e){var n=e.touches[0].clientX,g=e.touches[0].clientY,u=o+(n-a),d=s+(g-i);u=u>0?0:u,d=d>0?0:d;var f=c*r+d-c*gv.r,v=l*r+u-l*gv.r;d=0>f?d-f:d,u=0>v?u-v:u,t.style.left=u+"px",t.style.top=d+"px",e.preventDefault(),this.ontouchend=function(){this.ontouchmove=null,this.ontouchend=null}}var r=parseFloat(t.style.webkitTransform.split("(")[1].split(")")[0]);if(r.toFixed(2)===gv.r.toFixed(2))return!1;var a=e.touches[0].clientX,i=e.touches[0].clientY,o=parseFloat(t.style.left),s=parseFloat(t.style.top),c=parseFloat(t.style.height),l=parseFloat(t.style.width);return this.ontouchmove=n,!0}function zoom(e){var t=parseFloat(e.style.webkitTransform.split("(")[1].split(")")[0]),n=t,r=null,a=parseFloat(e.style.height),i=parseFloat(e.style.width),o=parseFloat(e.style.left),s=parseFloat(e.style.top);this.ontouchend=function(){this.ontouchmove=null,this.ontouchend=null},this.ontouchmove=function(c){var l=c.touches.length;if(2===l){c.preventDefault();var g=c.touches[0].clientX,u=c.touches[1].clientX,d=c.touches[0].clientY,f=c.touches[1].clientY,v=g-u,m=d-f,h=Math.pow(v,2)+Math.pow(m,2);if(h=Math.sqrt(h),null===r)return void(r=h);var p=n,S=(h-r)/(h+r);n=t+S,n=0>n?0:n,n=gv.r>n?gv.r:n;var y=(g+u)/2,b=(d+f)/2,w=qSC.findPos(e),A=(y-w[0])/p,L=(b-w[1])/p,T=A*(n-p),I=L*(n-p),q=o-T,M=s-I;q=q>0?0:q,M=M>0?0:M;var C=a*n+M-a*gv.r,O=i*n+q-i*gv.r;q=0>O?q-O:q,M=0>C?M-C:M,o=q,s=M,e.style.left=q+"px",e.style.top=M+"px",e.style.webkitTransform="scale("+n+")"}else r=null}}var v={},y={},t=function(e,t,n){function r(e,t){var n="s"+e+"s0";try{for(;t.id!=n;){if("a"==t.tagName.toLowerCase())return t.href;t=t.parentNode}}catch(r){return""}return""}function a(e,t){var n="s"+e+"s0";try{for(;t.id!=n;){if(t.DopPhGoto||t.DopPhVdo||t.DopPhAdo)return t;t=t.parentNode}}catch(r){return""}return""}gv.fn=t,y.t=e.substring(0,5),e=e.substring(5),y.i=k(e),e=m(e);var i=k(e),o=l(i);y.a=j(o),e=m(e),i=k(e),o=l(i),y.f=o,e=m(e),y.s=l(e),j(y.f),cfc.f(n,gft),siv();var s;try{gv.y.InitaliseSettings(cfc.dl())}catch(c){}try{0!=gv.s&&(s=presenter.loadXml("courseInfo.xml"),Player.SetPresenterDetails(s))}catch(g){}if(0!=gv.q)if("undefined"!=typeof zenler){var u=zenler.GetStringFromCurrentNode();qSC.loadXmlFrmTxt(u)}else gv.q.zXml="";var d=gv.o("resizer");if(gv.bs,d.style.backgroundColor=gv.bc,0!=gv.s&&(objDopPhSco=new DopPhSco(gv.s),objDopPhSco.Load()),0!=gv.q){var f=document.createElement("link");f.setAttribute("rel","stylesheet"),f.setAttribute("href",gv.d+gv.a+"/template.css"),document.getElementsByTagName("head")[0].appendChild(f),0==gv.s&&(qsh.initQuestionStruct(),qSC.loadQuizFromXml())}try{document.createEvent("TouchEvent"),gd="ontouchstart"in window?1:0}catch(v){gd=0}1==gd?d.ontouchstart=0==gv.q?function(e){function t(e){return e.changedTouches[0].clientX}if(!pan_Zoom(e,this)){var n=t(e);return d.ontouchend=function(i){var o=t(i);if(d.ontouchmove=d.ontouchend=null,n-o>100&&1==gv.j)ncc.n();else if(-100>n-o&&1==gv.j)ncc.p();else if(Math.abs(n-o)<10){var s=r(gc,e.target);if(""==s){var c=a(gc,e.target);c.DopPhGoto?hwr(c,0,c.DopPhGoto):c.DopPhVdo?video(c):c.DopPhAdo&&audio(c)}else try{window.open(s,"_blank")}catch(l){}}},!1}}:null:d.onclick=0==gv.q&&1==gv.g?ncc.n:null,document.body.onkeydown=0==gv.q&&1==gv.k?function(e){var t;e||(e=window.event),e.keyCode?t=e.keyCode:e.which&&(t=e.which),(39==t||40==t)&&ncc.n(),(37==t||38==t)&&ncc.p()}:null,slideLoader.adSldScrpt(gc),cfc.q(gc)};return t}(),slideLoader=function(){function e(e){if(!anima["s"+e].s.a){0===gln&&(gln=1,gv.y.OnLoadingStart());var t="";if(gv.bs)return t=e,anima["s"+e].s.a=!0,void loadContent("",e,"");var n=document.createElement("script");n.setAttribute("charset","UTF-8"),n.setAttribute("src",gv.d+gv.a+"/slideVault"+t+".js"),document.getElementsByTagName("head")[0].appendChild(n)}}return{adSldScrpt:e}}();Cbfun=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}(),UpdategT=function(){if(1==gpp)return null;if(gtct=(new Date).getTime(),gt=gtct-gStartTime,gv.y.OnProgressChange(gt),1==gx){if(gt>=gslength[gc-1]+anima["s"+gc].t.i){if(gxf)return gxf=!1,tranend(1),0;gxf=!0}return gafi=Cbfun(UpdategT),null}if(anima["s"+gc].f=gt,gt>=acc.g[anima["s"+gc].g]){pause();var e=gt-acc.g[anima["s"+gc].g];return gtct-=e,anima["s"+gc].f=gt=acc.g[anima["s"+gc].g],anima["s"+gc].g++,1==fcon?("undefined"!=typeof acc.g[anima["s"+gc].g]&&(gv.y.OnMovToNxtAnim(),acc.P(),play()),fcon=0):1==anima["s"+gc].a&&("undefined"!=typeof acc.g[anima["s"+gc].g]?(acc.P(),play()):ncc.n()),0}return gafi=Cbfun(UpdategT),null},AnCl=function(){function z(c,q){for(n in c)if("i"!=n)switch(c[n].c4){case 1:case 2:0==c[n].v&&(c[n].v="undefined"!=typeof window[c[n].c5]?eval("new "+c[n].c5+"(c[n])"):new Fade(c[n]),c[n].v.Initialize(q));break;case 3:0==c[n].v&&(c[n].v="undefined"!=typeof window[c[n].c5]?eval("new "+c[n].c5+"(c[n])"):new Spin(c[n]),c[n].v.Initialize(q));break;case 4:0==c[n].v&&(c[n].v=eval("new "+c[n].c5+"(c[n])"),c[n].v.Initialize(q));break;case 5:if(0==c[n].v)switch(c[n].c5){case 5:c[n].v=new aVideo(c[n],q);break;case 6:c[n].v=new aVideo(c[n],q);break;case 7:c[n].v=new aVideo(c[n],q)}break;case 8:if(0==c[n].v)switch(c[n].c5){case 8:c[n].v=new aaudio(c[n],q);break;case 9:c[n].v=new aaudio(c[n],q);break;case 0:c[n].v=new aaudio(c[n],q)}break;case"n":c[n].v=new autoAdvance(c[n])}}this.g=new Array,this.P=function(){for(var e=this.l(),t=0;t<e.length;t++)e[t].IniTSd&&e[t].play()},this.p=function(){for(var e=this.l(),t=0;t<e.length;t++)e[t].IniTSd&&e[t].pause()},this.s=function(){for(var e=this.l(),t=0;t<e.length;t++)e[t].IniTSd&&e[t].stop()},this.r=function(){for(var e=this.l(),t=0;t<e.length;t++)e[t].IniTSd&&e[t].reset()},this.t=function(){this.g.splice(0,this.g.length);var e=anima["s"+gc],t=e.t.i;if(e=e.c,0!=e)for(var n in e)"i"!=n&&(t+=e[n].i,this.g[this.g.length]=gslength[gc-1]+t);else this.g[0]=0},this.l=function(){var e=new Array,t=anima["s"+gc].g,n=anima["s"+gc];n=n.c,n=n["c"+t];for(var r in n)"i"!=r&&(0==n[r].v&&z(n,this.g[anima["s"+gc].g]-n.i),e[e.length]=n[r].v);return e}};var acc=new AnCl;NvCl=function(){function e(e,n){e.p=gv.o("narration"+n);try{t(e)}catch(r){}}function t(e){e.p.height=e.h,e.p.width=e.w,e.p.setAttribute("style","top:"+e.t+"px;left:"+e.l+"px;position:absolute;"),e.p.play()}this.P=function(){var e;if(0==gp){for(e=0;e<au.length;e++)au[e][0].play();return acc.g[anima["s"+gc].g]>gt?(play(),void acc.P()):void ncc.n()}for(pause(),e=au.length;e>=0;e--)"undefined"!=typeof au[e]&&"undefined"!=typeof au[e][0]&&au[e][0].pause();acc.p()},this.Ps=function(){pause();for(var e=au.length-1;e>=0;e--)au[e][0].pause()},this.n=function(e){function t(t){if(gc<gv.t||1==e||t){if(0!=gpc||gv.bs||(gpc=gc,cfc.sn(gc),cfc.hf.remove(gc)),1!=e){if(t?gc=1:gc++,gv.bs?(cfc.q(gc),gc=parseInt(gv.b)):cfc.q(gc),gv.bs)return anima["s"+gv.b].s.a||slideLoader.adSldScrpt(gv.b),void(anima["s"+gv.b].s.b||(gli=setTimeout(function(){ncc.n(1)},50),0===gln&&(gv.y.OnLoadingStart(),gln=1)));cfc.s(gc)}if(!cfc.l(gc))return void(gli=setTimeout(function(){ncc.n(1)},50));anima["s"+gc].g=0;for(var r=function(){if(1>e||e>gv.t)return 0;var t=new Array,r=anima["s"+e];if(r=r.c,0!=r)for(n in r)if("i"!=n){var a=r[n];for(var i in a)if("i"!=i){if(0==a[i].v)return t;t[t.length]=a[i].v}}return t},a=r.length-1;a>0;a--)r[a].reset();cfc.m(),anima["s"+gc].f=gt=gslength[gc-1],gStartTime-=gslength[gc-1]-anima["s"+gpc].f,acc.t(),ncc.y(),cfc.hf.add(gc),0!=gv.s&&objDopPhSco.UpdateLesson(gc,gv.t)}}if(1==gx)return void tranend();if(1!=e&&0!=gln){if(gc==gv.t)return;return clearTimeout(gli),void t(!1)}if(1!=e&&0==gln){if(gslength[gc]<=gt&&(anima["s"+gc].g>=acc.g.length||0==anima["s"+gc].c))return gc==gv.t?(ncc.a(1),void(gv.loop&&t(!0))):(pause(),anima["s"+gc].f<anima["s"+gc].c.i&&anima["s"+gc].g++,void t(!1));if(1==gp)return gStartTime-=acc.g[anima["s"+gc].g]-gt,anima["s"+gc].f=gt=acc.g[anima["s"+gc].g],gv.y.OnProgressChange(gt),void(fcon=1);if(acc.g[anima["s"+gc].g]>=gt){if(1==gp)pause(),gStartTime=gStartTime+gt-acc.g[anima["s"+gc].g],anima["s"+gc].f=gt=acc.g[anima["s"+gc].g],gv.y.OnProgressChange(gt),anima["s"+gc].g++;else{gv.y.OnMovToNxtAnim(),acc.P();for(var r=0;r<au.length;r++)au[r][0].play();play()}return}}t(!1)},this.p=function(e){function t(t){if(clearTimeout(gli),0==gpc&&(gpc=gc,cfc.sn(gc),cfc.hf.remove(gc)),1!=e){if(t?gc=gv.t:gc--,gv.bs?(cfc.q(gc),gc=parseInt(gv.b)):cfc.q(gc),gv.bs&&!anima["s"+gv.b].s.a&&slideLoader.adSldScrpt(gv.b),gv.bs&&!anima["s"+gv.b].s.b)return gli=setTimeout(function(){ncc.p(1)},50),void(0===gln&&gv.y.OnLoadingStart());cfc.s(gc)}return!gv.bs||anima["s"+gv.b].s.c?cfc.l(gc)?void n():void(gli=setTimeout(function(){ncc.p(1)},100)):void 0}function n(){cfc.hf.add(gc),cfc.m(),acc.t(),gStartTime+=anima["s"+gpc].f-gslength[gc-1],gt=gslength[gc-1],gv.y.OnProgressChange(gt),ncc.y()}if(1==gx)return void tranend();if(1!=e&&0!=gln)return 1==gc?void ncc.a(0):void t(!1);if(1!=e&&0==gln){if(gt-anima["s"+gc].t.i>gslength[gc-1])return 1==gp?pause():acc.g.indexOf(gt)>-1&&anima["s"+gc].g--,acc.r(),acc.s(),anima["s"+gc].g>0?(gStartTime+=gt-acc.g[anima["s"+gc].g-1],anima["s"+gc].f=gt=acc.g[anima["s"+gc].g-1]):(gStartTime+=gt-gslength[gc-1]-anima["s"+gc].t.i,anima["s"+gc].f=gt=gslength[gc-1]+anima["s"+gc].t.i),gv.y.OnMovToPrvAnim(),void gv.y.OnProgressChange(gt);gc>1?t(!1):gv.loop&&t(!0)}},this.z=function(e){function t(e){pause(),acc.s(),(!gv.bs||(anima["s"+e].s.a||slideLoader.adSldScrpt(e),anima["s"+e].s.b))&&cfc.s(e)}function n(){if(clearTimeout(gli),!gv.bs||anima["s"+gv.bs].s.c){if(!cfc.l(gc))return void(gli=setTimeout(function(){n()},100));acc.t(),gStartTime-=gslength[gc-1]-anima["s"+gpc].f,a(),cfc.q(gc)}}function r(){if(clearTimeout(gli),!gv.bs||anima["s"+gv.bs].s.c){if(!cfc.l(gc))return void(gli=setTimeout(function(){r()},100));acc.t(),gStartTime+=anima["s"+gpc].f-gslength[gc-1],a(),cfc.q(gc)}}function a(){gt=gslength[gc-1],gv.y.OnProgressChange(gt),cfc.hf.add(gc),ncc.y()}function i(){cfc.q(gc),cfc.m()}if(e=parseInt(e),!isNaN(e))if(0==gpc&&(gpc=gc,cfc.sn(gc),cfc.hf.remove(gc)),e==gv.t||e>gv.t)t(gv.t),gc=gv.t,i(),n();else if(e>gc)t(e),gc=e,i(),n();else{if(e==gc)return;e>0?(t(e),gc=e,i(),r()):0>e&&(t(1),gc=1,i(),r())}},this.y=function(){var t=anima["s"+gc];if("undefined"!=typeof t.q){var n=qsh.initQuestionSlide();if(n>0)return void ncc.z(n)}if(0!=t.n&&e(t.n,gc),t=anima["s"+gc].t,0!=t.c)0==t.v&&(t.v=new tran(t.c),t.v.initialize(gslength[gc-1])),t.v.play(),play();else{if(gpc!=gc&&gpc>0){var r=gv.o("s"+gpc+"s0");null!=r&&(gv.o("s"+gpc+"s0").style.display="none")}gv.o("s"+gc+"s0").style.display="block",gpc=0,gt=anima["s"+gc].f,gStartTime-=gt-gslength[gc-1],gv.y.OnProgressChange(gt),anima["s"+gc].f==gslength[gc-1]+anima["s"+gc].t.i?1==anima["s"+gc].t.n&&(acc.P(),play()):-1==acc.g.indexOf(anima["s"+gc].f)&&(acc.P(),play())}},this.a=function(e){0!=gv.s&&(objDopPhSco.scormendStatus||objDopPhSco.Quit(),objDopPhSco.scormendStatus=!0),"undefined"!=typeof loadCourseXml&&cfc.q(1==e?-1:0)}};var ncc=new NvCl;Cfc=function(){function e(e){function n(e){e.getElementsByTagName("video").length>0?e.DopPhVdo=!0:e.getElementsByTagName("audio").length>0&&(e.DopPhAdo=!0)}function r(e){var t=document.createElement("a");t.setAttribute("style",e.getAttribute("style")),t.innerHTML=e.innerHTML,t.className="DopPhAnchor "+e.className;try{i(t,e)}catch(n){}t.onmouseout=e.onmouseout,t.onmouseover=e.onmouseover;var r=e.parentNode;r.appendChild(t),r.removeChild(e)}function a(e){var t=e.childNodes,n=e;"div"===t[0].tagName.toLowerCase()&&(n=t[0]);var r=document.createElement("a");r.setAttribute("style","height:100%;width:100%;top:0px;left:0px;"),r.innerHTML=n.innerHTML,r.className="DopPhAnchor";try{i(r,e)}catch(a){}r.onmouseout=e.onmouseout,r.onmouseover=e.onmouseover,e.setAttribute("onclick",""),n.innerHTML="",n.appendChild(r)}function i(e,t){var n=document.createElement("div");n.innerHTML=t.onclick;var r=n.innerHTML,a=r.split(",");2==a[1]?(e.setAttribute("target","_blank"),e.href=gv.d+gv.a+"/"+a[2].split("'")[1]):1==a[1]?(e.setAttribute("target","_blank"),e.href=a[2].split("'")[1]):0==a[1]&&(e.DopPhGoto=a[2].split(")")[0],e.setAttribute("onclick",""),e.onclick=function(e){hwr(e.target,0,a[2].split(")")[0])})}for(var o=gv.o("s"+e+"s0"),s=t(o,"onclick"),c=s.length-1;c>=0;c--)"pre"===s[c].tagName.toLowerCase()?r(s[c]):"div"===s[c].tagName.toLowerCase()&&(s[c].getElementsByTagName("video").length>0||s[c].getElementsByTagName("audio").length>0?n(s[c]):a(s[c]))}function t(e,t){for(var n=[],r=e.getElementsByTagName("*"),a=0;a<r.length;a++)r[a].getAttribute(t)&&(n[n.length]=r[a]);return n}this.l=function(e){if(-1==gv.i[e])return 1==gln?gv.y.OnLoadingEnd():gln=0,!0;if(gv.bs&&!anima["s"+e].s.b)return!1;if(""!=window.location.host){var t=gv.o("s"+e+"s0").getElementsByTagName("img");try{if(0==t.length)throw"adsf"}catch(n){}for(var r=t.length-1;r>=0;r--)if(!t[r].complete)return 0===gln&&gv.y.OnLoadingStart(),gln=1,!1;if(-1==navigator.platform.indexOf("iPhone")&&-1==navigator.platform.indexOf("iPod")&&null==navigator.userAgent.match(/iPad/i)){for(t=gv.o("s"+e+"s0").getElementsByTagName("audio"),r=t.length-1;r>=0;r--)if(0==t[r].dopLoaded)return 0===gln&&gv.y.OnLoadingStart(),gln=1,!1;for(t=gv.o("s"+e+"s0").getElementsByTagName("video"),r=t.length-1;r>=0;r--)if(0==t[r].dopLoaded)return 0===gln&&gv.y.OnLoadingStart(),gln=1,!1}}return gv.y.OnLoadingEnd(),gln=0,gv.i[e]=-1,anima["s"+e].s.d=!0,!0},this.s=function(t){for(var r=t-2;t+5>r;r++)if(gv.bs&&(r=t),!(1>r||r>gv.t)){if(gv.bs&&!anima["s"+r].s.b)return;if(gv.bs&&anima["s"+r].s.c)return;if(!(gv.i[r]<1)){var a,i=gv.o("s"+r+"s0"),o=i.getElementsByTagName("img");o[0].src=gv.d+gv.a+"/sb"+gv.i[r]+gv.c;for(var s=1;s<o.length;s++){var c;c=""==o[s].src?".png":".gif",a=o[s].parentNode,o[s].src=gv.d+gv.a+"/"+a.id.replace("c","")+c}o=i.getElementsByTagName("video");var l;for(s=0;s<o.length;s++){var g;a=o[s].parentNode,g=-1!=o[s].id.indexOf("narration")?"narration"+r:"v"+a.parentNode.id,l=document.createElement("video"),l.setAttribute("height",o[s].height),l.setAttribute("width",o[s].width),l.setAttribute("id",g),l.dopLoaded=0,l.addEventListener("canplaythrough",function(){this.dopLoaded=1},!1),"mp3"==gv.v?l.setAttribute("src",gv.d+gv.a+"/"+g+".mp4"):l.setAttribute("src",gv.d+gv.a+"/"+g+".ogg"),l.setAttribute("preload",""),l.setAttribute("webkit-playsinline",""),a.removeChild(o[s]),a.appendChild(l);try{l.load()}catch(u){l.dopLoaded=1}}for(o=i.getElementsByTagName("audio"),s=0;s<o.length;s++){a=o[s].parentNode,l=document.createElement("audio"),l.dopLoaded=1,addEventListener("canplaythrough",function(){this.dopLoaded=1},!1),"mp3"==gv.v?l.setAttribute("src",gv.d+gv.a+"/a"+a.id+".mp3"):l.setAttribute("src",gv.d+gv.a+"/a"+a.id+".ogg"),l.setAttribute("id","a"+a.id),l.setAttribute("preload",""),a.removeChild(o[s]),a.appendChild(l);try{l.load()}catch(u){l.dopLoaded=1}}o=anima["s"+r],o=o.c;for(n in o)if("i"!=n)for(var d in o[n])"i"!=d&&"undefined"!=typeof o[n][d].c6&&5!=o[n][d].c5&&6!=o[n][d].c5&&7!=o[n][d].c5&&8!=o[n][d].c5&&9!=o[n][d].c5&&0!=o[n][d].c5&&("mp3"===gv.v?(l=document.createElement("audio"),l.setAttribute("id",o[n][d].c6),l.setAttribute("src",gv.d+gv.a+"/"+o[n][d].c6+".mp3"),i.appendChild(l)):(l=document.createElement("audio"),l.setAttribute("id",o[n][d].c6),l.setAttribute("src",gv.d+gv.a+"/"+o[n][d].c6+".ogg"),i.appendChild(l)));if(anima["s"+r].s.c=!0,e(r),gv.i[r]=0,gv.bs)return}}},this.q=function(e){gv.y.OnSlideChange(e)},this.r=function(e){e+=".js";var t=cfc.c(document.getElementsByTagName("head")[0],e,"script");null!=t&&document.getElementsByTagName("head")[0].removeChild(t)},this.c=function(e,t,n){function r(e,t){return-1!==e.indexOf(t,e.length-t.length)}for(var a=e.getElementsByTagName(n),i=0;i<a.length;i++)if(r(a[i].src,t))return a[i];return null},this.g=function(){var e={ogg:!1,mp3:!1},t=document.createElement("audio");try{if(!t.canPlayType)return void(gv.v=0);0===gv.v?e.mp3=!0:t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")?e.ogg=!0:t.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(e.mp3=!0)}catch(n){return void(gv.v=0)}gv.v=e.mp3?"mp3":"ogg"},this.f=function(e,t){if(0!=e.length){var n=document.createElement("style"),r=document.createElement("div");r.id="giItT1WQy";var a="giItT1WQy@!-/#";n.setAttribute("type","text/css"),n.setAttribute("id","DopFontFamily");for(var i=0;i<e.length;i++){var o=1===e[i][2]?"":'local("'+e[i][1]+'"),';n.innerHTML=n.innerHTML+'@font-face{font-family: "'+e[i][0]+'";src:'+o+'url("'+gv.d+gv.a+"/"+e[i][0]+"."+t+'");}';var s=document.createElement("pre");s.setAttribute("style","font-family:"+e[i]+";color:"+gv.bc+";"),s.innerHTML=a,r.appendChild(s)}var c=document.getElementsByTagName("head")[0];c.appendChild(n);var l=gv.o("resizer");l.appendChild(r)}},this.a=function(e,t){if("undefined"!=typeof e&&"undefined"!=typeof e.play){for(var n=[e,t],r=0;r<au.length;r++)if(au[r][0].id==e.id)return void(au[r][1]<t&&(au[r][1]=t));au[au.length]=n}},this.m=function(){function e(e){if(0!=gv.v){var t=au[e][0];try{t.paused||t.pause(),0!=t.currentTime&&(t.currentTime=0)}catch(n){}}}for(var t=0;t<au.length;t++)1==au[t][1]?(e(t),au.splice(t,1),t--):au[t][1]--},this.dl=function(){var e={};try{e.Width=gv.w,e.Height=gv.h,e.TotalSlides=gv.t,e.ShowNotes=gv.fn.length>0,e.TotalTime=gplength,e.MaxScale=gv.f,e.BackColr=gv.bc}catch(t){e=null}return e},this.sn=function(e){var t=gv.o("narration"+e);null!=t&&(t.currentTime=0,t.pause())},this.pn=function(e){var t=gv.o("narration"+e);null!=t&&t.play()},this.hf=function(){function e(e){for(var t=gv.o("s"+e+"s0"),r=t.getElementsByTagName("embed"),a=r.length-1;a>=0;a--){var i=r[a].parentNode,o="f"+i.id;if(null==gv.o(o)){var s,c=r[a].src,l={src:"",delay:0,openInNewWindow:!1},g=document.createElement("div");s=document.createElement(""===c?"embed":"iframe"),s.setAttribute("id",o),s.setAttribute("height","100%"),s.setAttribute("width","100%"),s.setAttribute("style","position:absolute;top:0px;left:0px;border:none;"),""===c?(l.src=gv.d+gv.a+"/f"+i.id+".swf",s.setAttribute("src",l.src),s.setAttribute("wmode","transparent")):(c=c.split("+++"),l.src=c[0],c[1]&&(l.delay=parseFloat(c[1])),c[2]&&(l.openInNewWindow="true"===c[2].toLowerCase().replace("/","")));var u,d=parseInt(i.style.top),f=parseInt(i.style.left),v=parseInt(i.style.width),m=parseInt(i.style.height);(0>m+d||0>v+f||d>gv.h||f>gv.w)&&(d=f=m=v=0),0>d&&(u=d,d=0,m+=u),0>f&&(u=f,f=0,v+=u),m+d>gv.h&&(m=gv.h-d),v+f>gv.w&&(v=gv.w-f),g.setAttribute("style","top:"+d/gv.h*100+"%;left:"+f/gv.w*100+"%;height:"+m/gv.h*100+"%;width:"+v/gv.w*100+"%;-webkit-overflow-scrolling:touch;overflow:auto;"),g.setAttribute("eCntnt","true"),i=gv.o("resizer"),i=i.parentNode,s.DopOtherOptions=l,function(){var e=s;e.style.display="none",e.DopTimeOut=function(e){if(e.parentNode.style.display="block",e.DopOtherOptions.openInNewWindow)e.src="",window.open(e.DopOtherOptions.src);else{if(!n(e))return;e.src=e.DopOtherOptions.src,e.style.display="block"}},g.DopTimeOutKey=setTimeout(function(){e.DopTimeOut(e)},l.delay)}(),l.openInNewWindow||g.appendChild(s),i.appendChild(g),g.style.display="none"}}}function t(){var e=gv.o("resizer");e=e.parentNode;for(var t=e.childNodes,n=[],r=t.length-1;r>=0;r--)if("undefined"!=typeof t[r].tagName){var a="true"==t[r].getAttribute("eCntnt");a&&(n[n.length]=t[r],t[r].DopTimeOutKey&&clearTimeout(t[r].DopTimeOutKey))}for(r=n.length-1;r>=0;r--)e.removeChild(n[r])}function n(e){if("https:"!=location.protocol)return!0;var t=e.DopOtherOptions.src;if(0==t.indexOf("https:"))return!0;if(0==t.indexOf("http:")){var n=document.createElement("a");return n.innerHTML=t+"</br> !! WARNING !! </br> Trying to load insecure content in secure page. Please click here to open content in new window.",n.setAttribute("href",t),n.setAttribute("target","blank"),e.parentNode.appendChild(n),n.setAttribute("style","color:black;font-family:arial;position:absolute;background-color:#b2b2b9"),!1}return!0}return{add:e,remove:t}}()};var cfc=new Cfc,presenter=function(){function e(e){for(var a={},i=r(e),o=0;o<i.childNodes.length;o++)if("presenter"==i.childNodes[o].nodeName.toLowerCase()){var s=i.childNodes[o];a.Presenter=t(s)}else if("attachments"==i.childNodes[o].nodeName.toLowerCase()){var c=i.childNodes[o].childNodes,l=n(c);a.Attachment=l}return a}function t(e){var t,n,r,a={};for(a.Details={},n=0;n<e.attributes.length;n++)t=e.attributes[n],a.Details[t.name]=t.value;for(var i=e.childNodes,o=0;o<i.length;o++)if("#text"!=i[o].nodeName.toLowerCase())for(r=i[o],a[r.nodeName]={},n=0;n<r.attributes.length;n++)t=r.attributes[n],a[r.nodeName][t.name]=t.value;return a}function n(e){var t,n,r,a={};for(r=0;r<e.length;r++)if("#text"!=e[r].nodeName.toLowerCase()){a[r]={},n=e[r];for(var i=0;i<n.attributes.length;i++)t=n.attributes[i],a[r][t.name]=t.value}return a}function r(e){var t;t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t.open("GET",e,!1),t.send();for(var n=t.responseXML,r=0;r<n.childNodes.length;r++)if("Course"==n.childNodes[r].nodeName)return n.childNodes[r];return n}return{loadXml:e}}(),arrayOfDivs=new Array,larrayOfDivs=new Array,gdS=new Object;QuestionHandler=function(){function e(e){var t;if(1==e[0]||2==e[0]||3==e[0]){var n=!1;for(t=0;t<arrayOfDivs.length;t++)1==arrayOfDivs[t].c&&(n=!0);if(!n)return alert(1==e[0]||2==e[0]?"Please choose an answer and then click Submit button.":"Please select at least one answer and then click Submit button."),!1}else{for(t=0;t<arrayOfDivs.length;t++)if(5==e[0]&&0==arrayOfDivs[t].c)return alert("Please match the answers and then click submit button."),!1;for(arrayOfDivs.sort(function(e,t){return parseInt(e.style.top)-parseInt(t.style.top)}),t=0;t<arrayOfDivs.length;t++)arrayOfDivs[t].c=5==e[0]&&0==arrayOfDivs[t].c?-1:t}return!0}function t(e){switch(gv.q.sCW||(e=0),e){case 0:case 1:ncc.z(gc+1);break;case 2:ncc.z(gc+2)}}function n(e,t){function n(e){for(var t=[],n=0,r=e.length;r>n;n++){var a=t.length;t[a]={},t[a].h=parseInt(e[n].style.height),t[a].w=parseInt(e[n].style.width),t[a].t=parseInt(e[n].style.top),t[a].l=parseInt(e[n].style.left),t[a].node=e[n]}return t}gdS.node=t,gdS.node.style.zIndex=10,gdS.node.style.opacity=.8,gdS.node.style.webkitTransform="scale(1.05)",gdS.node.style.MozTransform="scale(1.05)",gdS.node.style.OTransform="scale(1.05)",gdS.node.style.msTransform="scale(1.05)",gdS.dAray=n(arrayOfDivs);var a,o;1==gd?(a=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY):(a=e.clientX,o=e.clientY);var s=qSC.findPos(gv.o("resizer"));a-=s[0],o-=s[1];var c=parseInt(gdS.node.style.left),l=parseInt(gdS.node.style.top);gdS.comX=a/gv.r-c,gdS.comY=o/gv.r-l,e.preventDefault(),qSC.unclip(gdS.node),r(e),1==gd?(document.addEventListener("touchmove",r,!0),document.addEventListener("touchend",i,!0)):(document.addEventListener("mousemove",r,!0),document.addEventListener("mouseup",i,!0))}function r(e){var t,n;1==gd?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(t=e.clientX,n=e.clientY);var r=qSC.findPos(gv.o("resizer"));t-=r[0],n-=r[1];var i=t/gv.r-gdS.comX,o=n/gv.r-gdS.comY;gdS.node.style.left=i+"px",gdS.node.style.top=o+"px",a(i,o),e.preventDefault()}function a(e,t){for(var n=parseInt(gdS.node.style.width),r=parseInt(gdS.node.style.height),a=t+r/2,i=gdS.dAray.length-1,o=null;i>=0;){if(gdS.dAray[i].t<a&&a<gdS.dAray[i].t+gdS.dAray[i].h){o=gdS.dAray[i].node.id;break}i--}if(o!=gdS.node.id&&null!=o&&0==gdS.dAray[i].node.c){var s=gdS.dAray[i].l<=e&&e<gdS.dAray[i].l+gdS.dAray[i].w,c=gdS.dAray[i].l<e+n&&e+n<gdS.dAray[i].l+gdS.dAray[i].w;if(s||c){for(var l=gdS.dAray.length-1;l>=0&&gdS.dAray[l].node.hy!=gdS.node.hy;)l--;var g=gdS.node.hy;gdS.node.hy=gdS.dAray[i].node.hy,gdS.dAray[i].node.hy=g,gdS.dAray[i].node.style.top=g+"px";var u=gdS.dAray[i].l;gdS.dAray[i].l=gdS.dAray[l].l,gdS.dAray[l].l=u,u=gdS.dAray[i].t,gdS.dAray[i].t=gdS.dAray[l].t,gdS.dAray[l].t=u,u=gdS.dAray[i].h,gdS.dAray[i].h=gdS.dAray[l].h,gdS.dAray[l].h=u,u=gdS.dAray[i].w,gdS.dAray[i].w=gdS.dAray[l].w,gdS.dAray[l].w=u}}}function i(){function e(e){var t=parseInt(gdS.node.style.left),n=t+parseInt(gdS.node.style.width),r=parseInt(e.style.left),a=r+parseInt(e.style.width);return t>r&&a>t?!0:n>r&&a>n?!0:!1}var t=parseInt(gdS.node.style.top);t+=parseInt(gdS.node.style.height)/2;for(var n,o=0;o<larrayOfDivs.length;o++)if(n=larrayOfDivs[o].hy,t>=n&&t<=n+parseInt(larrayOfDivs[o].style.height)){if(0!=larrayOfDivs[o].c)break;e(larrayOfDivs[o])&&qSC.clip(larrayOfDivs[o],gdS.node);break}a(parseInt(gdS.node.style.left),parseInt(gdS.node.style.top)),gdS.node.style.top=gdS.node.hy+"px",0==gdS.node.c&&(gdS.node.style.left=gdS.node.hx+"px"),1==gd?(document.removeEventListener("touchmove",r,!0),document.removeEventListener("touchend",i,!0)):(document.removeEventListener("mousemove",r,!0),document.removeEventListener("mouseup",i,!0)),gdS.node.style.opacity=1,gdS.node.style.webkitTransform="scale(1)",gdS.node.style.MozTransform="scale(1)",gdS.node.style.OTransform="scale(1)",gdS.node.style.msTransform="scale(1)",gdS.node.style.zIndex=0}this.initQuestionStruct=function(){for(var e=gv.q.info.split("|"),t=0;t<e.length;t++)gv.q.sAray[t]=QH.LoadQuestionStruct(t)},this.initQuestionSlide=function(){var e,t=anima["s"+gc].q;if(0==t[0]){var r=qSC.HandleUnattendedQuestions();return r>0?r:(0!=gv.s&&objDopPhSco.End(),qSC.modifyResultSlide(gc)&&qSC.updateXmlAtEnd(),gv.q.cmpltd=!0,"undefined"!=typeof Player&&"undefined"!=typeof Player.sndFdBk&&Player.sndFdBk(),!1)}qSC.modifySlideAtInit(t);var a;if(null!=t[4]||gv.q.cmpltd){for(e=gv.o("s"+gc+"s"+t[3]),e.onclick=null,e.onmousedown=null,e.onmouseover=null,e.onmouseout=null,e.style.cursor="default",e.style.opacity=0,a=0;a<t[2].length;a++){if("object"==typeof t[2][a]){for(var i=0;i<t[2][a].length;i++)e=gv.o("s"+gc+"s"+t[2][a][i]),e.style.cursor="default",1==gd?(e.ontouchstart=null,e.ontouchmove=null,e.ontouchend=null):(e.onmousedown=null,e.onclick=null,e.onmouseover=null,e.onmouseout=null);return!1}e=gv.o("s"+gc+"s"+t[2][a]),1==gd?(e.ontouchstart=null,e.ontouchmove=null,e.ontouchend=null):(e.onmouseover=null,e.onmouseout=null,e.onclick=null,e.onmousedown=null),e.style.cursor="default"}return!1}for(arrayOfDivs.length>0&&arrayOfDivs.splice(0,arrayOfDivs.length),larrayOfDivs.length>0&&larrayOfDivs.splice(0,larrayOfDivs.length),null!=t[3]&&(e=gv.o("s"+gc+"s"+t[3]),e.style.cursor="pointer",e.onmouseover=function(){RListener(this)},e.onmouseout=function(){AListener(this)},e.onclick=function(){qsh.sb()}),a=0;a<t[2].length;a++)if("object"!=typeof t[2][a]){if(e=gv.o("s"+gc+"s"+t[2][a]),"undefined"==typeof e.c&&(e.hy=parseInt(e.style.top),e.hx=parseInt(e.style.left),e.c=0,e.onmouseover=function(){RListener(this)},e.onmouseout=function(){AListener(this)},e.style.cursor="pointer",4!=t[0]&&5!=t[0]&&qSC.checkUncheckOrder(e,t[0],0,"")),1==t[0]||2==t[0])e.onclick=function(){for(var e=0;e<arrayOfDivs.length;e++)arrayOfDivs[e].c=0,qSC.checkUncheckOrder(arrayOfDivs[e],1,0,"");this.c=1,qSC.checkUncheckOrder(this,1,1,"")};else if(3==t[0])e.onclick=function(){0==this.c?(this.c=1,qSC.checkUncheckOrder(this,3,1,"")):(this.c=0,qSC.checkUncheckOrder(this,3,0,""))
};else if((4==t[0]||5==t[0])&&(1==gd?e.ontouchstart=function(){n(event,this)}:e.onmousedown=function(){n(arguments[0]||event,this)},0==larrayOfDivs.length&&5==t[0]))for(var o=0;o<t[2][t[2].length-1].length;o++){var s=gv.o("s"+gc+"s"+t[2][t[2].length-1][o]);"undefined"==typeof s.c&&(s.hy=parseInt(s.style.top),s.hx=parseInt(s.style.left),s.c=0),larrayOfDivs.push(s)}arrayOfDivs.push(e)}},this.sb=function(){var n,r,a=anima["s"+gc].q,i=a[2],o=e(a,arrayOfDivs);if(o){for(r=0;r<arrayOfDivs.length;r++)n=arrayOfDivs[r].id.split("s"),n=parseInt(n[n.length-1]),n=i.indexOf(n),gv.q.sAray[a[1]-1].Answers[n]=arrayOfDivs[r].c;QH.SubmitAnswer(gv.q.sAray[a[1]-1]),qSC.updateAnsXml(gc);var s=QH.GetResult();s.qnsAtnd==s.tQns&&(gv.q.cmpltd=!0),0!=gv.s&&objDopPhSco.Submit(),t("b"==QH.GetStatus(a[1]-1)?1:2)}}},qsh=new QuestionHandler,QuizSupportClass=function(){function e(e,t,n){var r=t.slice(0);"object"==typeof r[r.length-1]&&r.pop(),r.sort(function(t,n){return parseInt(gv.o("s"+e+"s"+t).style.top)-parseInt(gv.o("s"+e+"s"+n).style.top)});for(var a=0;a<n.length;a++)r[a]=gv.o("s"+e+"s"+r[a]).style.top;var i;for(a=0;a<n.length;a++)i=n.indexOf(a),gv.o("s"+e+"s"+t[i]).style.top=r[a]}function t(e){function t(e,t,n){var r=document.createElement("div"),a=parseInt(e.style.left)-30;4==n&&(a=parseInt(e.style.left)-70),r.setAttribute("style","height:24px;width:24px;top:"+(parseInt(e.style.top)+(parseInt(e.style.height)-22)/2)+"px;left:"+a+"px;");var i=document.createElement("img");0==t?i.setAttribute("src",gv.d+"player/cross.png"):i.setAttribute("src",gv.d+"player/tick.png"),r.appendChild(i);var o=e.parentNode;o.appendChild(r)}var n=anima["s"+e].q;if(gv.q.sRv)for(var r,a=n[2],i=n[1],o=n[0],s=new Question(i-1,"a").Answers,c=gv.q.sAray[i-1].Answers,l=gv.q.sAray[i-1].Status,g=0;g<a.length;g++)switch(r=gv.o("s"+e+"s"+a[g]),o){case 1:case 2:case 3:1==s[g]&&t(r,1,o);break;case 4:s[g]==c[g]?"a"==l?t(r,0,o):t(r,1,o):t(r,0,o);break;case 5:if(null==r)break;r=gv.o("s"+e+"s"+a[a.length-1][g]),s[g]==c[g]?"a"==l?t(r,0,o):t(r,1,o):t(r,0,o)}}this.loadXmlFrmTxt=function(e){if(window.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLDOM");t.async=!1,t.loadXML(e),gv.q.zXml=t}else{var n=new DOMParser;gv.q.zXml=n.parseFromString(e,"text/xml")}var r,a=gv.q.zXml.getElementsByTagName("Track")[0];try{r=a.attributes.getNamedItem("cmpltd").value}catch(i){r="false",a.setAttribute("cmpltd",r)}gv.q.cmpltd="true"==r?!0:!1},this.loadQuizFromXml=function(){function e(e,t){for(var n=new Array,r=0;r<e.length;r++)n.push(e[r]);return n.sort(function(e,t){return parseInt(e.getAttribute("NewPos_y"))-parseInt(t.getAttribute("NewPos_y"))}),n.indexOf(t)}if(""!=gv.q.zXml){var t=gv.q.info.split("|"),n=gv.q.zXml.getElementsByTagName("Track")[0],r=n.getElementsByTagName("Question"),a=n.attributes.getNamedItem("status").value;gv.q.cmpltd="nc"===a||"sd"===a?!1:!0;for(var i=0,o=0;o<r.length;o++){"Passed"===r[o].attributes.getNamedItem("Flag").value&&(i+=gv.q.sAray[o].Score);var s=r[o].getElementsByTagName("Answer");if(s.length>0){var c=t[o],l=parseInt(c.substring(8,9)),g=c.substring(10,c.length);g=g.split("");for(var u=0;u<s.length;u++)gv.q.sAray[o].Answers[u]=0==l||1==l||2==l?"Passed"==s[u].getAttribute("Flag")?parseInt(g[u]):0==parseInt(g[u])?1:0:e(s,s[u]);QH.SubmitAnswer(gv.q.sAray[o])}else"Failed"==r[o].attributes.getNamedItem("Flag").value&&QH.SubmitAnswer(gv.q.sAray[o])}n.setAttribute("score",i)}},this.modifySlideAtInit=function(n){var r=n[1],a=n[0],i=gv.q.sAray[r-1];if((gv.q.cmpltd||"a"!=i.Status)&&0!=a&&0!=n[4]){n[4]=0;var o,s=n[2],c=i.Answers,l=new Question(r-1,"a").Answers;(4==a||5==a)&&"a"!=i.Status&&e(gc,s,c);for(var g=0;g<c.length;g++)if("object"!=typeof s[g])switch(o=gv.o("s"+gc+"s"+s[g]),a){case 1:case 2:case 3:if("a"==i.Status)qSC.checkUncheckOrder(o,a,0,"");else{if(!gv.q.sRv){1==c[g]?qSC.checkUncheckOrder(o,a,1,""):qSC.checkUncheckOrder(o,a,0,"");break}c[g]==l[g]?1==l[g]?qSC.checkUncheckOrder(o,a,c[g],"g"):qSC.checkUncheckOrder(o,a,l[g],""):qSC.checkUncheckOrder(o,a,c[g],"r")}break;case 4:if(!gv.q.sRv)break;"a"==i.Status?qSC.checkUncheckOrder(o,a,l[g]+1,"red"):c[g]==l[g]?qSC.checkUncheckOrder(o,a,c[g]+1,"green"):qSC.checkUncheckOrder(o,a,l[g]+1,"red");break;case 5:if("a"==i.Status)gv.q.sRv&&qSC.checkUncheckOrder(o,a,l[g]+1,"red");else{var u=s[s.length-1];qSC.clip(gv.o("s"+gc+"s"+u[g]),o),gv.q.sRv&&(c[g]==l[g]?qSC.checkUncheckOrder(o,a,c[g]+1,"green"):qSC.checkUncheckOrder(o,a,l[g]+1,"red"))}}t(gc)}},this.updateAnsXml=function(e){if(""!=gv.q.zXml){var t=anima["s"+e].q,n=t[2],r=t[1],a=new Question(r-1,"a"),i="b"===gv.q.sAray[r-1].Status?"Passed":"Failed",o=gv.q.zXml.createElement("Question");o.setAttribute("Index",r),o.setAttribute("Flag",i);for(var s=0;s<a.Answers.length;s++){var c=gv.q.zXml.createElement("Answer");a.Answers[s]===gv.q.sAray[r-1].Answers[s]?c.setAttribute("Flag","Passed"):c.setAttribute("Flag","Failed"),c.setAttribute("NewPos_y",parseInt(gv.o("s"+e+"s"+n[s]).style.top)),o.appendChild(c)}var l=gv.q.zXml.getElementsByTagName("Track")[0];l.setAttribute("time",zenler.GetTime(selectedContentIndex)),l.setAttribute("currentpageIndex",gc),l.setAttribute("currentquestionindex",r);var g=parseFloat(l.attributes.getNamedItem("score").value);"Passed"===i&&(g+=gv.q.sAray[r-1].Score),l.setAttribute("score",g),l.setAttribute("status","sd");var u=l.getElementsByTagName("Question")[r-1];l.replaceChild(o,u);var d,f=gv.q.zXml;d=window.ActiveXObject?f.xml:(new XMLSerializer).serializeToString(f),zenler.UpdateNodeContent(d)}},this.updateXmlAtEnd=function(){if(""!==gv.q.zXml){var e=gv.q.zXml.getElementsByTagName("Track")[0];e.setAttribute("currentpageIndex",gc),e.setAttribute("currentquestionindex",e.parentNode.attributes.getNamedItem("questioncount").value);var t=QH.GetResult();t.Status?e.setAttribute("status","pd"):e.setAttribute("status","fd");var n;if(window.ActiveXObject){var r=gv.q.zXml;n=r.xml}else n=(new XMLSerializer).serializeToString(gv.q.zXml);zenler.UpdateNodeContent(n)}},this.modifyResultSlide=function(e){function t(e,t){if(e=gv.o("s"+gc+"s"+e),null!=e){var n=e.getElementsByTagName("pre");if(n.length>0)n[n.length-1].innerHTML+=" : "+t;else{var r=document.createElement("pre"),a=parseInt(e.style.height);r.setAttribute("style","left:"+e.style.width+";top:"+a/4+"px;font-weight:bold;"),r.innerHTML=" : "+t,e.appendChild(r)}}}function n(e,t){var n,r="s"+gc+"s"+e,a=1,i=new Array;for(n=gv.o(r),n&&(n.style.display=t);null!=gv.o(r+"p"+a);)i[i.length]=gv.o(r+"p"+a),a++;for(a=0;a<i.length;a++)i[a]&&(i[a].style.display=t)}var r=anima["s"+e].q;if(null!=r[4])return!1;var a=QH.GetResult(),i=r[1];return t(i[0],a.tQns),t(i[1],a.tScore),t(i[2],a.pRate+" %"),t(i[3],a.qnsAtnd),t(i[4],a.cAnswrs),t(i[5],a.wAnswrs),t(i[6],a.yScore),null!=i[8]&&null!=gv.o("s"+gc+"s"+i[7])&&(a.Status?(n(i[7],"block"),n(i[8],"none")):(n(i[7],"none"),n(i[8],"block"))),r[4]=0,!0},this.HandleUnattendedQuestions=function(){function e(e){for(var t=1;t<gv.t;t++){var n=anima["s"+t];if(n=n.q,"undefined"!=typeof n&&n[1]==e)return t}return 0}if(gv.q.cmpltd)return 0;if(1==anima["s"+gv.t].q[5])return 0;for(var t=0;t<gv.q.sAray.length;t++)if("a"==gv.q.sAray[t].Status){var n=function(){this.yes=function(){anima["s"+gv.t].q[5]=0},this.no=function(){anima["s"+gv.t].q[5]=1,ncc.z(gv.t)}};return Player.ShowMsg('You have not attended one or more questions.\n\nClick "Yes" to attend remaining questions. \nClick "No" to finish the quiz without attending the remaining questions.',"Zenler","yesno",new n),e(gv.q.sAray[t].Index)}return 0},this.checkUncheckOrder=function(e,t,n,r){for(var a=e.getElementsByTagName("div"),i=null,o=0;o<a.length;o++)if(a[o].id.indexOf("qc")>0){i=a[o];break}switch(null==i&&(i=qSC.addDiv(e,e.id+"qc",0,0,t)),i.className="",t){case 1:case 2:i.className=1==n?"DOPrOn"+r:"DOPrOff"+r;break;case 3:i.className=1==n?"DOPtOn"+r:"DOPtOff"+r;break;case 4:if(0>n)break;l=parseInt(e.style.height);var s;s=""==i.innerHTML.trim(" ")?qSC.addPre(i,n,l):i.getElementsByTagName("pre")[0],s.style.color=r,i.style.left="20px";break;case 5:if(0>n)break;var c,l=parseInt(e.style.height);c=""==i.innerHTML.trim(" ")?qSC.addPre(i,n,l):i.getElementsByTagName("pre")[0],c.style.color=r,i.style.left="45px"}},this.addDiv=function(e,t,n,r,a){var i=document.createElement("div");return(4==a||5==a)&&i.setAttribute("style","top:"+n+"px;left:"+r+"px;"),i.setAttribute("id",t),e.appendChild(i),i},this.addPre=function(e,t,n){var r=document.createElement("pre");return r.setAttribute("style","font-size:20px;font-family:tahoma;font-weight:bold;"),r.innerHTML=t,e.appendChild(r),r.style.top=(n-24)/2+"px",r},this.clip=function(e,t){var n="undefined"==typeof e.hx?e.style.left:e.hx;n=parseInt(n);var r=parseInt(e.style.width),a=parseInt("undefined"==typeof t.hx?t.style.left:t.hx),i=parseInt(t.style.width),o=n+(a+i-n)/2,s=i-r;e.style.left=o-r+"px",t.style.left=o-s-10+"px",e.c=t.id,t.c=e.id},this.unclip=function(e){if(0!=e.c){var t=gv.o(e.c);e.c=0,t.c=0,e.style.left=e.hx+"px",t.style.left=t.hx+"px"}},this.findPos=function(e){var t=0,n=0;if(e.offsetParent)do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return[t,n]}};var qSC=new QuizSupportClass;QuizHandler=function(){this.LoadQuestionStruct=function(e){var t=new Question(e,"s");return t},this.GetStatus=function(e){var t=-1;return null!=gv.q.sAray[e]&&(t=gv.q.sAray[e].Status),t},this.SubmitAnswer=function(e){e.Status="b";for(var t=e.Index-1,n=new Question(t,"a"),r=0;r<n.Answers.length;r++)if(n.Answers[r]!=e.Answers[r]){e.Status="c";break}gv.q.sAray[t]=e},this.GetResult=function(){for(var e=gv.q.sAray.length,t=0,n=0,r=0,a=0,i=0;e>i;i++){var o=gv.q.sAray[i];t+=o.Score,"b"==o.Status?(n++,a+=o.Score):"c"==o.Status&&r++}var s=n+r,c=a/t*100>=gv.q.psRate,l={Status:c,tQns:e,tScore:t,pRate:gv.q.psRate,qnsAtnd:s,cAnswrs:n,wAnswrs:r,yScore:a};return l}},Question=function(e,t){var n=gv.q.info.split("|"),r=n[e];this.Index=parseInt(r.substring(0,3)),this.Score=parseFloat(r.substring(3,8)),this.Type=parseInt(r.substring(8,9)),this.Status="a",this.Answers=new Array;for(var a=0,i=10;i<r.length;i++,a++)this.Answers[a]="s"==t?0:parseInt(r.substring(i,i+1),16)};var QH=new QuizHandler,DopPhSco=function(e){var t;this.scormendStatus=!1;var n,r=function(){function e(){n=new i,0==gv.q?a.Load():o.Load(),window.onunload=r.onUnload}var r=function(){function e(){t=(new Date).getTime()}function a(){gv.t!==gc&&(n.doLMSSetValue("cmi.core.exit","suspend"),i())}function i(){r.GetTime(),n.doLMSCommit(),n.doLMSFinish()}function o(){if(0!=t)var e=(new Date).getTime(),r=(e-t)/1e3,a=s(r);else a="00:00:00.0";n.doLMSSetValue("cmi.core.session_time",a)}function s(e){var t=e%60;e-=t;var n=e%3600;e-=n,t=Math.round(100*t)/100;var r=new String(t),a=r,i="";-1!=r.indexOf(".")&&(a=r.substring(0,r.indexOf(".")),i=r.substring(r.indexOf(".")+1,r.length)),a.length<2&&(a="0"+a),r=a,i.length&&(r=r+"."+i);var o;o=e%3600!=0?0:e/3600;var s;s=n%60!=0?0:n/60,new String(o).length<2&&(o="0"+o),new String(s).length<2&&(s="0"+s);var c=o+":"+s+":"+r;return c}return{InitiateTimer:e,GetTime:o,onUnload:a,Quit:i}}(),a=function(){function e(){n.doLMSInitialize();var e=n.doLMSGetValue("cmi.core.lesson_status"),a=n.doLMSGetValue("cmi.core.lesson_location");(""==a||null==a)&&(a=1,t(1,gv.t)),scormGoTo(a),"completed"==e||"passed"==e?this.scormendStatus=!0:n.doLMSSetValue("cmi.core.lesson_status","incomplete"),r.InitiateTimer(),n.doLMSCommit(),t(a,gv.t)}function t(e,t){if(!this.scormendStatus){n.doLMSSetValue("cmi.core.lesson_location",e);var r=e/t*100;r=Math.round(100*r)/100,n.doLMSSetValue("cmi.core.score.raw",r);var i;i=100==r?"completed":"incomplete",a(i),n.doLMSCommit()}}function a(e){n.doLMSSetValue("cmi.core.lesson_status",e),"completed"==e&&(e="passed",n.doLMSSetValue("cmi.core.lesson_status",e))}return{Load:e,UpdateLesson:t}}(),o=function(){function e(){n.doLMSInitialize();var e=n.doLMSGetValue("cmi.core.lesson_location");(null==e||""==e)&&(e=1),scormGoTo(e),n.doLMSSetValue("cmi.core.lesson_location",e);var t=n.doLMSGetValue("cmi.core.lesson_status");"failed"==t||"passed"==t||"completed"==t?t="completed":(t="incomplete",n.doLMSSetValue("cmi.core.lesson_status",t)),gv.q.cmpltd="incomplete"==t?!1:!0;var a=n.doLMSGetValue("cmi.suspend_data");""==a||null==a?(qsh.initQuestionStruct(),a=i(gv.q.sAray),n.doLMSSetValue("cmi.suspend_data",a)):gv.q.sAray=o(a);var s=QH.GetResult();gv.q.pasd=s.Status?!0:!1,n.doLMSCommit(),r.InitiateTimer()}function t(){var e=QH.GetResult(),t=e.yScore/e.tScore*100;t=Math.round(100*t)/100,n.doLMSSetValue("cmi.core.score.raw",t);var r=i(gv.q.sAray);n.doLMSSetValue("cmi.suspend_data",r),n.doLMSSetValue("cmi.core.lesson_location",gc),e.tQns==e.qnsAtnd&&(gv.q.cmpltd=!0);var a;a=gv.q.cmpltd?"completed":"incomplete",n.doLMSSetValue("cmi.core.lesson_status",a);var o;e.Status?(o="passed",n.doLMSSetValue("cmi.core.lesson_status",o)):gv.q.cmpltd&&(o="failed",n.doLMSSetValue("cmi.core.lesson_status",o)),n.doLMSCommit()}function a(){var e,t=QH.GetResult();e=t.Status?"passed":"failed";var r=t.yScore/t.tScore*100;r=Math.round(100*r)/100,n.doLMSSetValue("cmi.core.score.raw",r),n.doLMSSetValue("cmi.core.lesson_status",e),n.doLMSCommit()}function i(e){for(var t="",n=0;n<e.length;n++){t+=s(e[n].Index,3)+c(e[n].Score)+e[n].Status+e[n].Type+e[n].Answers.length;for(var r=0;r<e[n].Answers.length;r++)t+=e[n].Answers[r];t+="|"}return t.substring(0,t.length-1)}function o(e){for(var t=e.split("|"),n=new Array,r=0;r<t.length;r++)n[r]=new l(t[r]);return n}function s(e,t){for(e+="";e.length<t;)e="0"+e;return e}function c(e){return e=e.toFixed(2),e=s(e,5)}var l=function(e){this.Index=parseInt(e.substring(0,3)),this.Score=parseFloat(e.substring(3,8)),this.Status=e.substring(8,9),this.Type=parseInt(e.substring(9,10)),e=e.substring(11,e.length),this.Answers=e.split("");for(var t=0;t<this.Answers.length;t++)this.Answers[t]=parseInt(this.Answers[t])};return{createString:i,createArray:o,Load:e,Submit:t,End:a}}();return{Load:e,Quit:r.Quit,UpdateLesson:a.UpdateLesson,End:o.End,Submit:o.Submit}},a=function(){function e(){n=new o,0==gv.q?a.Load():i.Load(),window.onunload=r.onUnload}var r=function(){function e(){t=(new Date).getTime()}function a(){gv.t!==gc&&(n.doSetValue("cmi.exit","suspend"),i())}function i(){r.GetTime(),n.doCommit(),n.doTerminate()}function o(){if(0!=t)var e=(new Date).getTime(),r=(e-t)/1e3,a=s(r);else a="PT00H00M00S";n.doSetValue("cmi.session_time",a)}function s(e){var t=e%60;e-=t;var n=e%3600;e-=n,t=Math.round(100*t)/100;var r=new String(t),a=r,i="";-1!=r.indexOf(".")&&(a=r.substring(0,r.indexOf(".")),i=r.substring(r.indexOf(".")+1,r.length)),a.length<2&&(a="0"+a),r=a,i.length&&(r=r+"."+i);var o;o=e%3600!=0?0:e/3600;var s;s=n%60!=0?0:n/60,new String(o).length<2&&(o="0"+o),new String(s).length<2&&(s="0"+s);var c="PT"+o+"H"+s+"M"+r+"S";return c}return{InitiateTimer:e,GetTime:o,onUnload:a,Quit:i}}(),a=function(){function e(){n.doInitialize();var e=n.doGetValue("cmi.completion_status"),a=n.doGetValue("cmi.location");(""==a||null==a)&&(a=1,t(1,gv.t)),scormGoTo(a),"completed"==e?this.scormendStatus=!0:n.doSetValue("cmi.completion_status","incomplete"),r.InitiateTimer(),n.doCommit(),t(a,gv.t)}function t(e,t){if(!this.scormendStatus){n.doSetValue("cmi.location",e);var r=e/t*100;a(r);var o;o=100==r?"completed":"incomplete",i(o),n.doCommit()}}function a(e){n.doSetValue("cmi.score.min",0),n.doSetValue("cmi.score.max",100),n.doSetValue("cmi.score.raw",e),n.doSetValue("cmi.score.scaled",e/100),n.doSetValue("cmi.progress_measure",e/100)}function i(e){n.doSetValue("cmi.completion_status",e),e="completed"==e?"passed":"failed",n.doSetValue("cmi.success_status",e)}return{Load:e,UpdateLesson:t}}(),i=function(){function e(){n.doInitialize();var e=n.doGetValue("cmi.location");(null==e||""==e)&&(e=1),scormGoTo(e),n.doSetValue("cmi.location",e);var t=n.doGetValue("cmi.completion_status");("not_attempted"==t||"unknown"==t||""==t)&&(t="incomplete",n.doSetValue("cmi.completion_status",t)),gv.q.cmpltd="incomplete"==t?!1:!0;var a=n.doGetValue("cmi.suspend_data");""==a||null==a?(qsh.initQuestionStruct(),a=i(gv.q.sAray),n.doSetValue("cmi.suspend_data",a)):gv.q.sAray=o(a),"completed"!=t&&gc==gv.t&&n.doSetValue("cmi.completion_status","completed");var s=n.doGetValue("cmi.success_status");gv.q.pasd="passed"==s?!0:!1,n.doCommit(),r.InitiateTimer()}function t(){var e=QH.GetResult(),t=e.yScore,a=e.yScore/e.tScore;n.doSetValue("cmi.score.min",0),n.doSetValue("cmi.score.max",e.tScore),n.doSetValue("cmi.score.raw",t),n.doSetValue("cmi.score.scaled",a);var o=i(gv.q.sAray);n.doSetValue("cmi.suspend_data",o),n.doSetValue("cmi.location",gc),e.tQns==e.qnsAtnd&&(gv.q.cmpltd=!0);var s;s=gv.q.cmpltd?"completed":"incomplete",n.doSetValue("cmi.completion_status",s);var c;c=e.Status?"passed":gv.q.cmpltd?"failed":"unknown",n.doSetValue("cmi.success_status",c),n.doCommit(),gv.q.cmpltd&&r.Quit()}function a(){var e=QH.GetResult(),t=e.yScore,a=e.yScore/e.tScore;n.doSetValue("cmi.score.min",0),n.doSetValue("cmi.score.max",e.tScore),n.doSetValue("cmi.score.raw",t),n.doSetValue("cmi.score.scaled",a),n.doSetValue("cmi.location",gc);var i="completed";n.doSetValue("cmi.completion_status",i);var o;o=e.Status?"passed":"failed",n.doSetValue("cmi.success_status",o),n.doCommit(),r.Quit()}function i(e){for(var t="",n=0;n<e.length;n++){t+=s(e[n].Index,3)+c(e[n].Score)+e[n].Status+e[n].Type+e[n].Answers.length;for(var r=0;r<e[n].Answers.length;r++)t+=e[n].Answers[r];t+="|"}return t.substring(0,t.length-1)}function o(e){for(var t=e.split("|"),n=new Array,r=0;r<t.length;r++)n[r]=new l(t[r]);return n}function s(e,t){for(e+="";e.length<t;)e="0"+e;return e}function c(e){return e=e.toFixed(2),e=s(e,5)}var l=function(e){this.Index=parseInt(e.substring(0,3)),this.Score=parseFloat(e.substring(3,8)),this.Status=e.substring(8,9),this.Type=parseInt(e.substring(9,10)),e=e.substring(11,e.length),this.Answers=e.split("");for(var t=0;t<this.Answers.length;t++)this.Answers[t]=parseInt(this.Answers[t])};return{createString:i,createArray:o,Load:e,Submit:t,End:a}}();return{Load:e,Quit:r.Quit,UpdateLesson:a.UpdateLesson,End:i.End,Submit:i.Submit}},i=function(){function e(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nLMSInitialize was not successful."),"false";var t=e.LMSInitialize("");return"true"!=t.toString()&&l(),t.toString()}function t(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nLMSFinish was not successful."),"false";var t=e.LMSFinish("");return"true"!=t.toString()&&l(),t.toString()}function n(e){var t=g();if(null==t)return alert("Unable to locate the LMS's API Implementation.\nLMSGetValue was not successful."),"";var n=t.LMSGetValue(e),r=t.LMSGetLastError().toString();if(r!=v._NoError){var a=t.LMSGetErrorString(r);return alert("LMSGetValue("+e+") failed. \n"+a),""}return n.toString()}function r(e,t){var n=g();if(null==n)return void alert("Unable to locate the LMS's API Implementation.\nLMSSetValue was not successful.");var r=n.LMSSetValue(e,t);"true"!=r.toString()&&l()}function a(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nLMSCommit was not successful."),"false";var t=e.LMSCommit("");return"true"!=t&&l(),t.toString()}function i(){var e=g();return null==e&&alert("Unable to locate the LMS's API Implementation.\nLMSGetLastError was not successful."),e.LMSGetLastError().toString()}function o(e){var t=g();return null==t&&alert("Unable to locate the LMS's API Implementation.\nLMSGetErrorString was not successful."),t.LMSGetErrorString(e).toString()}function s(e){var t=g();return null==t&&alert("Unable to locate the LMS's API Implementation.\nLMSGetDiagnostic was not successful."),t.LMSGetDiagnostic(e).toString()}function c(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nLMSIsInitialized() failed."),!1;e.LMSGetValue("cmi.core.student_name");var t=e.LMSGetLastError().toString();return t==v._NotInitialized?!1:!0}function l(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nCannot determine LMS error code."),null;var t=e.LMSGetLastError().toString();if(t!=v._NoError){var n=e.LMSGetErrorString(t);1==f&&(n+="\n",n+=e.LMSGetDiagnostic(null)),alert(n)}return t}function g(){return null==m&&(m=d()),m}function u(e){for(;null==e.API&&null!=e.parent&&e.parent!=e;){if(h++,h>7)return alert("Error finding API -- too deeply nested."),null;e=e.parent}return e.API}function d(){var e=u(window);return null==e&&null!=window.opener&&"undefined"!=typeof window.opener&&(e=u(window.opener)),null==e&&alert("Unable to find an API adapter"),e}var f=!1,v={_NoError:0,_NotInitialized:301},m=null,h=0;return{doLMSFinish:t,doLMSInitialize:e,doLMSGetValue:n,doLMSSetValue:r,doLMSCommit:a,doLMSGetLastError:i,doLMSGetErrorString:o,doLMSGetDiagnostic:s,LMSIsInitialized:c}},o=function(){function e(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nInitialize was not successful."),"false";var t=e.Initialize("");return"true"!=t.toString()&&l(),t.toString()}function t(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nTerminate was not successful."),"false";var t=e.Terminate("");return"true"!=t.toString()&&l(),t.toString()}function n(e){var t=g();if(null==t)return alert("Unable to locate the LMS's API Implementation.\nGetValue was not successful."),"";var n=t.GetValue(e),r=t.GetLastError().toString();return r!=v._NoError?"":n.toString()}function r(e,t){var n=g();if(null==n)return alert("Unable to locate the LMS's API Implementation.\nSetValue was not successful."),null;var r=n.SetValue(e,t);if("true"!=r.toString()){var a=l();r=a}return r}function a(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nCommit was not successful."),"false";var t=e.Commit("");return"true"!=t&&l(),t.toString()}function i(){var e=g();return null==e?(alert("Unable to locate the LMS's API Implementation.\nGetLastError was not successful."),null):e.GetLastError().toString()}function o(e){var t=g();return null==t&&alert("Unable to locate the LMS's API Implementation.\nGetErrorString was not successful."),t.GetErrorString(e).toString()}function s(e){var t=g();return null==t&&alert("Unable to locate the LMS's API Implementation.\nGetDiagnostic was not successful."),t.GetDiagnostic(e).toString()}function c(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nlmsIsInitialized() failed."),!1;e.GetValue("cmi.core.student_name");var t=e.GetLastError().toString();return t==_NotInitialized?!1:!0}function l(){var e=g();if(null==e)return alert("Unable to locate the LMS's API Implementation.\nCannot determine LMS error code."),null;var t=e.GetLastError().toString();if(t!=v._NoError){var n=e.GetErrorString(t);1==f&&(n+="\n",n+=e.GetDiagnostic(null)),alert(n)}return t}function g(){return null==m&&(m=d()),m}function u(e){for(var t=0;null==e.API_1484_11&&null!=e.parent&&e.parent!=e&&h>=t;)t++,e=e.parent;return e.API_1484_11}function d(){var e=null;return null!=window.parent&&window.parent!=window&&(e=u(window.parent)),null==e&&null!=window.top.opener&&(e=u(window.top.opener)),e}var f=!1,v={_NoError:0},m=null,h=500;return{doInitialize:e,doTerminate:t,doGetValue:n,doSetValue:r,doCommit:a,doGetLastError:i,doGetErrorString:o,doGetDiagnostic:s,LMSIsInitialized:c}};return"2004"==e?new a:new r};